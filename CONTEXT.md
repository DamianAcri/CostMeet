# ü™™ Nombre del proyecto

**CostMeet**

Herramienta SaaS minimalista que calcula el coste real de las reuniones en euros, d√≥lares (o la moneda que elija el usuario)... ayudando a las empresas a tomar decisiones basadas en datos y optimizar su tiempo y recursos.

---

# üéØ Prop√≥sito

Reducir el despilfarro de tiempo y dinero en reuniones innecesarias o sobredimensionadas proporcionando visibilidad clara sobre su coste.

---

# üß† Problema que resuelve

* Las reuniones consumen miles de euros al mes sin aportar valor real.
* Muchas empresas no son conscientes de su coste en tiempo y dinero.
* No hay herramientas simples que muestren esta informaci√≥n de forma clara y accionable.

---

# üë• Target

* Startups y PYMEs entre 10 y 250 empleados.
* Fundadores, managers, product owners.
* Equipos que usan Google Calendar y se preocupan por su eficiencia.

---

# üí° Propuesta de valor

* Calcula el coste de cada reuni√≥n.
* Dashboards semanales y mensuales con resumen del gasto.
* Alertas configurables cuando se supera un umbral.
* Rankings de reuniones m√°s caras.
* Conciencia inmediata sobre si una reuni√≥n deber√≠a o no hacerse.

---

# ‚öôÔ∏è MVP - ESTADO ACTUAL: ‚úÖ COMPLETADO

## Funcionalidades implementadas:

1. ‚úÖ Login con Google (OAuth) + Email/Password
2. ‚úÖ Crear reuni√≥n manualmente
   * N¬∫ de asistentes (1-100)
   * Duraci√≥n en minutos (1-1440)
   * Salario medio estimado (0-10,000)
   * Fecha personalizable
   * Descripci√≥n opcional
3. ‚úÖ C√°lculo del coste en tiempo real
4. ‚úÖ Guardado de reuniones en Supabase
5. ‚úÖ Dashboard completo:
   * Total gastado semanalmente
   * Total de reuniones semanales
   * Coste promedio por reuni√≥n
   * Total hist√≥rico de reuniones y costes
   * Lista de reuniones ordenadas por fecha
   * Edici√≥n y eliminaci√≥n de reuniones
6. ‚úÖ Interfaz responsive y moderna
7. ‚úÖ Actualizaciones autom√°ticas sin recargar p√°gina
8. ‚úÖ Gesti√≥n de perfiles de usuario

## Arquitectura t√©cnica implementada:

### üèóÔ∏è **ESTRUCTURA DEL PROYECTO**
```
src/
‚îú‚îÄ‚îÄ app/                 # App Router de Next.js
‚îú‚îÄ‚îÄ components/          # Componentes reutilizables
‚îú‚îÄ‚îÄ contexts/           # Context API para autenticaci√≥n
‚îú‚îÄ‚îÄ hooks/              # Custom hooks (useMeetings)
‚îú‚îÄ‚îÄ lib/                # Utilidades y configuraciones
‚îî‚îÄ‚îÄ public/             # Archivos est√°ticos
```

### üîê **AUTENTICACI√ìN Y SEGURIDAD**
- Supabase Auth con OAuth (Google) y email/password
- Row Level Security (RLS) implementado
- Validaci√≥n de variables de entorno
- Gesti√≥n centralizada de errores
- Logs protegidos para producci√≥n

### üìä **BASE DE DATOS**
- PostgreSQL con Supabase
- Tablas: `profiles` y `meetings`
- Columna generada autom√°ticamente para `total_cost`
- Triggers para `updated_at`
- Pol√≠ticas de seguridad RLS

### üé® **COMPONENTES PRINCIPALES**
- `AuthContext`: Gesti√≥n centralizada de autenticaci√≥n
- `useMeetings`: Hook personalizado para CRUD de reuniones
- `ProtectedRoute`: Protecci√≥n de rutas
- `NewMeetingForm`: Formulario de creaci√≥n con validaci√≥n
- `EditMeetingModal`: Modal de edici√≥n
- `MeetingsList`: Lista de reuniones
- `StatsCards`: Tarjetas de estad√≠sticas

### üöÄ **FUNCIONALIDADES AVANZADAS**
- Actualizaciones optimistas (UI se actualiza inmediatamente)
- C√°lculo de costes en tiempo real
- Validaci√≥n de formularios con mensajes de error
- Manejo de estados de carga
- Responsive design con TailwindCSS
- Sin valores hardcodeados (todo en constantes)

---

# üì¶ Stack recomendado

* **Frontend**: Next.js + TailwindCSS
* **Backend**: Next.js API routes (o Supabase functions si todo en Supabase)
* **Base de datos**: Supabase (PostgreSQL)
* **Auth**: Supabase OAuth (Google)
* **Gr√°ficas**: Recharts
* **Deploy**: Vercel

---

# üí∏ Monetizaci√≥n futura

**Modelo Freemium**

* Free: Hasta 10 reuniones al mes
* Pro: 9‚Ç¨/mes (100 reuniones, sync con calendario)
* Business: 29‚Ç¨/mes (ilimitado, export PDF, multiusuario)

**Objetivo inicial:**
25 clientes Pro ‚Üí 225‚Ç¨/mes
50 clientes Pro ‚Üí 450‚Ç¨/mes

---

# üõ£Ô∏è Roadmap resumido

| D√≠a    | Acciones                                     |
| ------ | -------------------------------------------- |
| 1      | MVP b√°sico: auth, crear reuniones, dashboard |
| 2      | Deploy + feedback temprano                   |
| 3      | Mejora UI + alertas                          |
| 4      | Mini lanzamiento LinkedIn + feedback         |

---

# üì≤ UI inicial (despu√©s de login)

* Dashboard central:

  * Total gastado esta semana (n√∫mero grande)
  * Lista de reuniones recientes
  * Bot√≥n "+ Nueva reuni√≥n"

* Men√∫ lateral:

  * Historial
  * Ranking
  * Ajustes

Minimal, claro, muy enfocado en acci√≥n y visualizaci√≥n inmediata.

---

# ‚úÖ Objetivo de Damian

Construir el MVP funcional de CostMeet en 3-5 d√≠as, ponerlo en producci√≥n (Vercel), recibir feedback y validar si tiene tracci√≥n para evolucionar a versi√≥n Pro.

---

# üèóÔ∏è Arquitectura Implementada

## üìÅ Estructura de Carpetas Creadas

### `/src/lib/`
- **`supabase/client.ts`** - Cliente de Supabase con validaci√≥n de variables de entorno
- **`supabase/types.ts`** - Tipos TypeScript para las tablas de la base de datos (sin duplicaci√≥n de cliente)
- **`constants.ts`** - Constantes centralizadas para configuraci√≥n, rutas y validaciones

### `/src/contexts/`
- **`AuthContext.tsx`** - Context centralizado para manejo de autenticaci√≥n

### `/src/components/`
- **`ProtectedRoute.tsx`** - Componentes para protecci√≥n de rutas

### `/src/app/login/`
- **`page.tsx`** - P√°gina de inicio de sesi√≥n

### `/src/app/dashboard/`
- **`page.tsx`** - Dashboard principal (√°rea privada)

## üóÑÔ∏è Base de Datos (Supabase)

### Tabla: `profiles`
```sql
-- Extiende auth.users de Supabase
id: uuid (PK, FK a auth.users)
email: text
full_name: text
avatar_url: text
currency: text (default 'EUR')
default_hourly_rate: numeric (default 50.00)
company_name: text
created_at: timestamp
updated_at: timestamp
```

**Pol√≠ticas RLS:**
- Users can view own profile
- Users can update own profile  
- Users can insert own profile

### Tabla: `meetings`
```sql
id: uuid (PK)
user_id: uuid (FK a profiles)
title: text (required)
description: text
attendees_count: integer (required, > 0)
duration_minutes: integer (required, > 0)
average_hourly_rate: numeric (required, > 0)
total_cost: numeric (calculado autom√°ticamente)
currency: text (default 'EUR')
meeting_date: timestamp
created_at: timestamp
updated_at: timestamp
```

**Pol√≠ticas RLS:**
- Users can view own meetings
- Users can insert own meetings
- Users can update own meetings
- Users can delete own meetings

**C√°lculo autom√°tico:**
`total_cost = (attendees_count * average_hourly_rate * duration_minutes) / 60.0`

### Funci√≥n: `handle_new_user()`
Trigger que crea autom√°ticamente un perfil cuando se registra un usuario.

## üîê Sistema de Autenticaci√≥n Centralizado

### AuthContext (`/src/contexts/AuthContext.tsx`)

**Estados:**
- `user: User | null` - Usuario actual de Supabase
- `profile: Profile | null` - Perfil extendido del usuario
- `session: Session | null` - Sesi√≥n actual
- `loading: boolean` - Estado de carga

**M√©todos:**
- `signInWithEmail(email, password)` - Inicio de sesi√≥n con email/contrase√±a
- `signUpWithEmail(email, password, fullName)` - Registro con email/contrase√±a
- `signInWithGoogle()` - Inicio de sesi√≥n con Google OAuth (opcional)
- `signOut()` - Cerrar sesi√≥n
- `updateProfile(updates)` - Actualizar perfil del usuario
- `resetPassword(email)` - Recuperar contrase√±a por email
- `fetchProfile(userId)` - Obtener perfil del usuario
- `createProfile(userId)` - Crear perfil manualmente si no existe

**Funcionalidades:**
- ‚úÖ Sincronizaci√≥n autom√°tica con Supabase auth
- ‚úÖ Manejo de estados de carga
- ‚úÖ Persistencia de sesi√≥n
- ‚úÖ Actualizaci√≥n autom√°tica de perfil
- ‚úÖ Creaci√≥n autom√°tica de perfil si falla el trigger
- ‚úÖ Logs condicionales (solo en desarrollo)
- ‚úÖ Constantes centralizadas para rutas y configuraci√≥n
- ‚úÖ Validaci√≥n robusta de errores

### Componentes de Protecci√≥n (`/src/components/ProtectedRoute.tsx`)

**`ProtectedRoute`:**
- Protege rutas que requieren autenticaci√≥n
- Redirige a `/login` si no hay usuario
- Muestra spinner de carga durante verificaci√≥n

**`PublicRoute`:**
- Protege rutas p√∫blicas (login, registro)
- Redirige a `/dashboard` si ya hay usuario autenticado
- Evita que usuarios logueados vean p√°ginas de login

## üìÑ P√°ginas Implementadas

### `/src/app/page.tsx` (Home)
- **Funci√≥n:** Redirige autom√°ticamente seg√∫n estado de auth
- **L√≥gica:** 
  - Usuario logueado ‚Üí `/dashboard`
  - Usuario no logueado ‚Üí `/login`
  - Muestra spinner durante verificaci√≥n

### `/src/app/login/page.tsx`
- **Protecci√≥n:** `PublicRoute` (solo no autenticados)
- **Funcionalidades:**
  - üîë **Login con Email/Contrase√±a** (principal)
  - üü¢ **Registro con Email/Contrase√±a**
  - üìß **Recuperaci√≥n de contrase√±a**
  - üîµ **Login con Google** (opcional)
  - Cambio din√°mico entre modos (login/signup/reset)
  - Validaci√≥n de formularios
  - Manejo de errores espec√≠ficos
  - Estados de carga
  - UI moderna y accesible

### `/src/app/dashboard/page.tsx`
- **Protecci√≥n:** `ProtectedRoute` (solo autenticados)
- **Funcionalidades:**
  - Header con avatar y bot√≥n logout
  - Cards de estad√≠sticas (esta semana, reuniones, promedio)
  - Botones de acci√≥n r√°pida
  - Lista de reuniones recientes (vac√≠a inicialmente)

### `/src/app/layout.tsx`
- **Actualizado con:**
  - `AuthProvider` envolviendo toda la app
  - Metadata actualizada para CostMeet
  - Idioma espa√±ol

## üîß Configuraci√≥n y Mejoras Implementadas

### Variables de Entorno (`.env.local`)
```bash
NEXT_PUBLIC_SUPABASE_URL=https://jlurakrexxvcckcogtuf.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
**‚úÖ Validaci√≥n autom√°tica:** El cliente Supabase valida que las variables existan

### Constantes Centralizadas (`/src/lib/constants.ts`)
- **AUTH_CONFIG:** Rutas, c√≥digos de error, configuraci√≥n por defecto
- **VALIDATION_RULES:** Reglas de validaci√≥n para formularios
- **Elimina hardcodeo:** Todas las rutas y valores est√°n centralizados

### Dependencias Instaladas
- `@supabase/supabase-js` - Cliente de Supabase
- `@heroicons/react` - Iconos
- `lucide-react` - Iconos adicionales

### Mejoras de Seguridad y Calidad
- ‚úÖ **Sin duplicaci√≥n de cliente Supabase**
- ‚úÖ **Validaci√≥n de variables de entorno**
- ‚úÖ **Constantes centralizadas** (no m√°s hardcodeo)
- ‚úÖ **Manejo robusto de errores** con mensajes espec√≠ficos
- ‚úÖ **Logs condicionales** (solo en desarrollo)
- ‚úÖ **Validaciones de formulario** mejoradas
- ‚úÖ **Fallback de creaci√≥n de perfil** manual
- ‚úÖ **Tipos TypeScript** completos y limpios

## üéØ Estado Actual del MVP

### ‚úÖ Completado (v1.0 - Ready for Production)
1. **Autenticaci√≥n centralizada** - Sistema robusto, escalable y sin hardcodeo
2. **Base de datos** - Esquema completo con RLS y trigger autom√°tico
3. **Rutas protegidas** - Navegaci√≥n segura con constantes centralizadas
4. **UI base** - Login y Dashboard funcionales con manejo de errores mejorado
5. **Tipos TypeScript** - Tipado completo de BD sin duplicaciones
6. **Validaciones robustas** - Formularios con validaci√≥n y feedback espec√≠fico
7. **Fallbacks de seguridad** - Creaci√≥n manual de perfil si falla el trigger
8. **C√≥digo limpio** - Sin hardcodeo, constantes centralizadas, logs condicionales

### üîÑ Pr√≥ximo (Pendiente)
1. **Formulario crear reuni√≥n** - CRUD de meetings
2. **C√°lculos en tiempo real** - Dashboard con datos reales
3. **Reportes y estad√≠sticas** - An√°lisis de costos
4. **Exportaci√≥n** - CSV/PDF de reportes

## üõ†Ô∏è Flujos de Autenticaci√≥n

### Opci√≥n 1: Email/Contrase√±a (Principal)
1. **Usuario no autenticado** ‚Üí P√°gina `/` ‚Üí Redirect a `/login`
2. **Formulario din√°mico** ‚Üí Registro/Login/Reset seg√∫n modo seleccionado
3. **Supabase auth** ‚Üí Validaci√≥n y procesamiento
4. **Trigger autom√°tico** ‚Üí Crea perfil en tabla `profiles`
5. **AuthContext actualiza** ‚Üí `user`, `profile`, `session`
6. **Usuario autenticado** ‚Üí Redirect a `/dashboard`

### Opci√≥n 2: Google OAuth (Alternativa)
1. **Click "Login con Google"** ‚Üí OAuth Google ‚Üí Callback a `/dashboard`
2. **Resto igual** que opci√≥n 1

### Recuperaci√≥n de Contrase√±a
1. **Modo reset** ‚Üí Ingresa email ‚Üí **Supabase env√≠a email de recuperaci√≥n**
2. **Usuario hace click** ‚Üí Enlace redirige a p√°gina de reset
3. **Nueva contrase√±a** ‚Üí Login autom√°tico

### Logout
- **Logout** ‚Üí Limpia estados del AuthContext ‚Üí Redirect a `/login`

---

## üÜò Configuraci√≥n de Supabase Requerida

### 1. Ejecutar SQL (en SQL Editor de Supabase)
```sql
-- Copiar y ejecutar todas las consultas SQL de las tablas mencionadas arriba
-- Incluir: profiles, meetings, handle_new_user function y trigger
```

### 2. Configurar Auth
- **Email Auth:** ‚úÖ Habilitado por defecto en Supabase
- **Google OAuth:** ‚öôÔ∏è Opcional - Si quieres mantener Google como alternativa
  - En Authentication > Providers > Google
  - Configurar Client ID y Secret de Google Console

### 3. Email Templates (Opcional)
- En Authentication > Email Templates
- Personalizar emails de confirmaci√≥n y reset de contrase√±a

---
